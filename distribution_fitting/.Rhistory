#This block of code will not appear in your knitted document
#Setup paths for data and Rcode
require("knitr")
sourcedir <-"C:/Users/justi/OneDrive/Documents/College/Fall 2024/Linear Statistical Models/R_Code"
traindir <- "C:/Users/justi/OneDrive/Documents/College/Fall 2024/Linear Statistical Models/Data/Trains"
opts_knit$set(root.dir = sourcedir)
opts_chunk$set(warning=FALSE)
setwd(sourcedir)
source("AccidentInput.R")
source("PCAplots.R")
source("princompreg.R")
library(ggplot2)
library(psych)
library(dplyr)
library(lattice)
library(GGally)
library(ggpubr)
library(ggfortify)
library(MASS)
library(lindia)
library(olsrr)
library(here)
library(readr)
library(tidyverse)
library(plyr)
library(scales)
library(grid)
library(car)
# Load a list of data frames for each year of accident data
acts <- file.inputl(traindir)
# combine into one data frame
totacts <- combine.data(acts)
# setup categorical variables
totacts$TYPE <- factor(totacts$TYPE, labels = c("Derailment", "HeadOn",
"Rearend", "Side", "Raking", "BrokenTrain", "Hwy-Rail",
"GradeX", "Obstruction", "Explosive", "Fire","Other",
"SeeNarrative" ))
totacts$TYPEQ <- factor(totacts$TYPEQ, labels = c("NA", "Freight", "Passenger", "Commuter",
"Work",  "Single", "CutofCars", "Yard", "Light", "Maint",
"MaintOfWay", "Passenger", "Commuter", "ElectricMulti", "ElectricMulti"))
totacts$Cause <- rep(NA, nrow(totacts))
totacts$Cause[which(substr(totacts$CAUSE, 1, 1) == "M")] <- "M"
totacts$Cause[which(substr(totacts$CAUSE, 1, 1) == "T")] <- "T"
totacts$Cause[which(substr(totacts$CAUSE, 1, 1) == "S")] <- "S"
totacts$Cause[which(substr(totacts$CAUSE, 1, 1) == "H")] <- "H"
totacts$Cause[which(substr(totacts$CAUSE, 1, 1) == "E")] <- "E"
totacts$Cause <- factor(totacts$Cause)
##Build a data frame with only extreme accidents for ACCDMG
dmgbox <- ggplot(totacts, aes(y=ACCDMG)) + geom_boxplot()
upper <- ggplot_build(dmgbox)$data[[1]]$ymax
xdmg <- totacts[totacts$ACCDMG > upper,]
# remove 9/11
xdmg <- xdmg[-179,]
## Remove duplicates from xdmg and call new data frame xdmgnd
xdmgnd <- xdmg[!(duplicated(xdmg[, c("INCDTNO", "YEAR", "MONTH", "DAY", "TIMEHR", "TIMEMIN")])),]
rownames(xdmgnd) <- NULL
totacts
#Question 37
xdmgnd$DERAIL <- if_else(xdmgnd$TYPE == 1,1, 0)
accdmg.lm3<-lm(ACCDMG~DERAIL, data=xdmgnd)
summary(accdmg.lm3)
library(ggplot2)
library(psych)
library(dplyr)
library(lattice)
library(GGally)
library(ggpubr)
library(ggfortify)
library(MASS)
library(lindia)
library(olsrr)
library(here)
library(readr)
library(tidyverse)
library(plyr)
library(scales)
library(grid)
library(car)
library(fitdistrplus)
library(EnvStats)
traindir <- "C:/Users/justi/OneDrive/Documents/College/Fall 2024/Capstone/devcom_capstone/distribution_fitting"
setwd(traindir)
df <- read.table("accuracy.csv", sep=",", header=T)
#Model
acc.lm<-lm(accuracy ~ human + night + temp + wind + vis + precip + rocky + sandy + swampy + wooded,data=df)
#Model Stats
summary(acc.lm)
#Model Stats
summary(acc.lm)
AIC(acc.lm)
BIC(acc.lm)
#Outputting model summary as png
tmp <- tempfile()
options(xtable.comment=FALSE)  ## removes the nasty comments
capture.output(xtable(summary(acc.lm)), file=tmp)
#Outputting model summary as png
tmp <- tempfile()
options(xtable.comment=FALSE)  ## removes the nasty comments
capture.output(xtable(summary(acc.lm)), file=tmp)
rmarkdown::render(tmp, output_format="pdf_document", output_file="V:/xyz.pdf")
#Outputting model summary as png
outputdir <- "C:/Users/justi/OneDrive/Documents/College/Fall 2024/Capstone/xyz.pdf"
tmp <- tempfile()
capture.output(summary(acc.lm), file=tmp)
rmarkdown::render(tmp, output_format="pdf_document", output_file=outputdir)
unlink(tmp)
pdftools::pdf_convert(outputdir, format="png")
#export model
summ(acc.lm)
#export model
export_summs(acc.lm, scale = TRUE, to.file = "docx", file.name = "test.docx")
library(jtools)
library(jtools)
library(jtools)
#export model
summ(acc.lm)
export_summs(acc.lm, scale = TRUE, to.file = "docx", file.name = "test.docx")
export_summs(acc.lm, scale = TRUE, to.file = "docx", file.name = "test.docx")
(acc.lm)
#export model
summ(acc.lm)
export_summs(acc.lm, scale = TRUE, to.file = "docx", file.name = "test.docx")
#export model
acc.lm1<-lm(accuracy ~ human + night + temp + wind + rocky + sandy + swampy + wooded,data=df)
summ(acc.lm1)
export_summs(acc.lm, scale = TRUE, to.file = "docx", file.name = "test.docx")
#export model
acc.lm1<-lm(accuracy ~ human + night + temp + wind + rocky + sandy + swampy + wooded,data=df)
summ(acc.lm1)
export_summs(acc.lm1, scale = TRUE, to.file = "docx", file.name = "test.docx")
library(officer)
#export model
acc.lm1<-lm(accuracy ~ human + night + temp + wind + rocky + sandy + swampy + wooded,data=df)
summ(acc.lm1)
export_summs(acc.lm1, scale = TRUE, to.file = "docx", file.name = "test.docx")
library(huxtable)
summ(acc.lm1)
export_summs(acc.lm1, scale = TRUE, to.file = "docx", file.name = "test.docx")
library(flextable)
export_summs(acc.lm1, scale = TRUE, to.file = "docx", file.name = "test.docx")
